---
title: "Total Market Sizes"
author: "Ali Ghanbari"
date: "April 23, 2018"
output: html_document
---

```{r}
library(caret)
library(corrplot)
library(readxl)
```

Now we can read the data after installing packages
```{r}
sc<-read_xlsx("C:\\Users\\Ali\\Documents\\Texas State\\My Research\\Data\\Data preparation\\scissor preparation for market size.xlsx")
```
```{r}
set.seed(1234)
```
then we split data randomly into train and test data
```{r}
ind<-createDataPartition(sc$Year,p=0.8,list = FALSE)
train<-sc[ind,]
test<-sc[-ind,]
```
detecting N/A variables
```{r}
nearzero<-nearZeroVar(train,saveMetrics = TRUE)
```
omitting N/A variables
```{r}
train<-train[,!nearzero$nzv]
```
```{r}
 View(train)
```
Column 1 and 2 are not needed
```{r}
train<-train[,-c(1,2)]
```
then we can see the corr of variables 
```{r}
corrplot(cor(sc[,3:14]),method = "number")
```
Before running the model we want to be usre about corr and preprocess
```{r}
c<-findCorrelation(cor(train[,-1]),cutoff = 0.85)
names(train[c])

c<-findCorrelation(cor(train[,-1]),cutoff = 0.75)
names(train[c])

```
It is obviuos that the corr between some variables are significant
So we can use principal component analysis for preprocess 
```{r}
tc<-trainControl(method = "repeatedcv",number = 5,repeats = 3,preProcOptions = "pca")
```
Also cross validation technique going to apply
```{r}
svmradial<-train(TMS~.,data=train,method="svmRadial",trControl=tc)
p<-predict(svmradial,newdata = test)

 svmradial
 
 p
 
 plot(svmradial)
 
 
```
now svm linear
```{r}
svmlinear<-train(TMS~.,data=train,method="svmLinear",trControl=tc)
svmlinear

p<-predict(svmlinear,test)
p

```

the neural net
```{r}
library(nnet)
nn<-train(TMS~.,data=train,method="nnet",trControl=tc)

nn
p<-predict(nn,test)

p

plot(nn)
```
then random forest
```{r}
RF<-train(TMS~.,data=train,method="rf",trControl=tc)
p<-predict(RF,test)

RF

p

plot(RF)
```

